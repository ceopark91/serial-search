<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì‹œë¦¬ì–¼ ë„˜ë²„ ê²€ìƒ‰ê¸° | Serial Number Search</title>

<style>
:root{
  --bg:#0b1020; --card:#111a33; --line:#23305a;
  --text:#eaf0ff; --muted:#9aa7c2; --accent:#38bdf8; --danger:#fb7185;
}
*{box-sizing:border-box}
body{margin:0; background:linear-gradient(180deg,#0b1020,#05070d); font-family:Pretendard,"Noto Sans KR",system-ui; color:var(--text)}
.wrapper{max-width:1200px; margin:auto; padding:32px 16px 80px}
header{margin-bottom:32px; border-bottom:1px solid var(--line); padding-bottom:24px}
header h1{margin:0; font-size:28px}
header p{margin:8px 0 0; color:var(--muted); font-size:14px}
.search-box{
  background:var(--card); border:1px solid var(--line); border-radius:16px;
  padding:24px; margin-bottom:32px; display:flex; gap:12px;
}
.search-box input{
  flex:1; padding:12px 16px; border-radius:10px;
  border:1px solid var(--line); background:#070a14; color:var(--text);
}
.search-box button{
  padding:12px 20px; border-radius:10px; border:none;
  font-weight:700; cursor:pointer;
}
.btn-search{background:var(--accent); color:#000}
.btn-reset{background:var(--line); color:var(--text)}
.result-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:20px}
.card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:20px}
.card-header{border-bottom:1px solid var(--line); padding-bottom:12px; margin-bottom:12px}
.card-title{color:var(--accent); font-weight:600}
.info-grid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
.info-item{background:#070a14; border:1px solid var(--line); border-radius:10px; padding:10px}
.info-label{font-size:12px; color:var(--muted)}
.info-value{font-size:14px; white-space:normal; line-height:1.4}
.cert-section{margin-top:12px; padding-top:12px; border-top:1px solid var(--line)}
.cert-btn{
  display:inline-block; padding:10px 16px;
  background:var(--accent); color:#000; border-radius:8px;
  text-decoration:none; font-weight:600;
}
.empty{
  padding:40px; border:2px dashed var(--line);
  border-radius:12px; text-align:center; color:var(--danger);
}
footer{margin-top:40px; text-align:center; color:var(--muted); font-size:12px}
@media(max-width:768px){
  .result-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrapper">
<header>
  <h1>ğŸ” ì‹œë¦¬ì–¼ ë„˜ë²„ ê²€ìƒ‰ê¸°</h1>
  <p>JSON DB ê¸°ë°˜ ê²€ìƒ‰</p>
</header>

<section class="search-box">
  <input id="serialInput" placeholder="ì˜ˆ: DM202510117">
  <button class="btn-search" onclick="search()">ê²€ìƒ‰</button>
  <button class="btn-reset" onclick="resetForm()">ì´ˆê¸°í™”</button>
</section>

<section id="result"></section>
<footer>Â© SEDNAENG</footer>
</div>

<script>
/* =========================
   ğŸ”§ DB ìœ„ì¹˜ (ì¤‘ìš”)
   ========================= */
const SERIAL_DB_URL =
  "https://ceopark91.github.io/serial-search/serial_db.json";
const CERT_DB_URL =
  "https://ceopark91.github.io/serial-search/certificate_db.json";

let SERIAL_DB = {};
let CERT_DB = {};

/* ===== ì‹œë¦¬ì–¼ ì •ê·œí™” ===== */
function normalizeSerial(raw){
  if(!raw) return "";
  let v = raw.toUpperCase().replace(/\s+/g,"");
  let out = "";
  for(let i=0;i<v.length;i++){
    const ch=v[i];
    if((i===3||i===4)&&/[A-Z]/.test(ch)) continue;
    out+=ch;
  }
  return out;
}

/* ===== ì¤„ë°”ê¿ˆ í‘œì‹œ ===== */
const nl = t => (t||"").replace(/\n/g,"<br>");

/* ===== DB ë¡œë“œ ===== */
async function loadDB(){
  [SERIAL_DB, CERT_DB] = await Promise.all([
    fetch(SERIAL_DB_URL).then(r=>r.json()),
    fetch(CERT_DB_URL).then(r=>r.json())
  ]);
}

/* ===== ê²€ìƒ‰ ===== */
function findSerial(input){
  const key = normalizeSerial(input);
  for(const k in SERIAL_DB){
    const row = SERIAL_DB[k];
    if(row.sn_list.includes(key)){
      return {
        ...row,
        certificate: CERT_DB[key] || ""
      };
    }
  }
  return null;
}

/* ===== ê²°ê³¼ ë Œë” ===== */
function render(hit){
  if(!hit) return `<div class="empty">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</div>`;
  return `
  <div class="result-grid">
    <div class="card">
      <div class="card-header">
        <div class="card-title">ê²€ìƒ‰ ê²°ê³¼</div>
      </div>
      <div class="info-grid">
        <div class="info-item"><div class="info-label">ì—…ì²´ëª…</div><div class="info-value">${nl(hit.company)}</div></div>
        <div class="info-item"><div class="info-label">ëª¨ë¸ëª…</div><div class="info-value">${nl(hit.model)}</div></div>
        <div class="info-item"><div class="info-label">ë‚©í’ˆì¼</div><div class="info-value">${nl(hit.delivery_date)}</div></div>
        <div class="info-item"><div class="info-label">W/P ë‚©í’ˆì¼</div><div class="info-value">${nl(hit.wp_date)}</div></div>
        <div class="info-item"><div class="info-label">ìˆ˜ëŸ‰</div><div class="info-value">${nl(hit.qty)}</div></div>
        <div class="info-item"><div class="info-label">í”„ë¡œì íŠ¸</div><div class="info-value">${nl(hit.project)}</div></div>
      </div>
      <div class="cert-section">
        ${hit.certificate
          ? `<a href="${hit.certificate}" target="_blank" class="cert-btn">ğŸ“¥ ì„±ì ì„œ ë‹¤ìš´ë¡œë“œ</a>`
          : `<span class="info-label">ì„±ì ì„œ ë¯¸ë“±ë¡</span>`
        }
      </div>
    </div>
  </div>`;
}

/* ===== ë²„íŠ¼ ===== */
async function search(){
  const v = document.getElementById("serialInput").value;
  const box = document.getElementById("result");
  if(!v){ box.innerHTML=`<div class="empty">ì‹œë¦¬ì–¼ ì…ë ¥ í•„ìš”</div>`; return; }
  const hit = findSerial(v);
  box.innerHTML = render(hit);
}

function resetForm(){
  document.getElementById("serialInput").value="";
  document.getElementById("result").innerHTML="";
}

/* ===== ì´ˆê¸° ===== */
window.addEventListener("load", async ()=>{
  await loadDB();
  const p = new URLSearchParams(location.search);
  if(p.get("sn")){
    document.getElementById("serialInput").value = p.get("sn");
    search();
  }
});
</script>
</body>
</html>

